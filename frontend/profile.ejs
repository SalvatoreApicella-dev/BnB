<div class="card card-signin my-5">
    <div class="card-body">
    <h5 class="card-title text-center">Aggiorna e modifica i tuoi dati</h5>
  
      <form action="api/users/update<%= session.user._id %>" method="POST" enctype="multipart/form-data"
            id="form-signup" class="needs-validation" novalidate>
        <div class="card mb-5">
  
          <div class="card-header text-white bg-primary">Dati personali</div>
  
          <div class="card-body">
  
            <img class="rounded mx-auto d-block" width="100" height="100" alt="profile picture" src="#" id="profilePicture">

            <br /><br />

            <div class="form-row">
  
              <div class="col-md-4 mb-3">
                <label for="firstname">Nome</label>
                <input type="text" class="form-control" id="firstname" name="firstname" placeholder="Nome"
                       value="<%= session.user.name.first %>" required>
                <div class="invalid-feedback">
                  L'inserimento del nome è obbligatorio
                </div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="lastname">Cognome</label>
                <input type="text" class="form-control" id="lastname" name="lastname" placeholder="Cognome"
                       value="<%= session.user.name.last %>" required>
                <div class="invalid-feedback">
                  L'inserimento del cognome è obbligatorio
                </div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="username">Username</label>
                <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="inputGroupPrepend3">@</span>
                  </div>
                  <input type="text" class="form-control" id="username" name="username" placeholder="Username"
                         value="<%= session.user.username %>" pattern="[a-z0-9]{4,20}" aria-describedby="inputGroupPrepend3">
                  <div class="invalid-feedback">
                    L'username deve essere tra 4 e 20 caratteri alfanumerici (minuscoli).
                  </div>
                </div>
              </div>
  
            </div>
        
  
            <div class="form-row">
  
              <div class="col-md-6 mb-3">
                <label for="email">E-mail</label>
                <input type="email" class="form-control" id="email" name="email" placeholder="E-mail"
                       value="<%= session.user.email %>" required>
                <div class="invalid-feedback">
                  Inserire un indirizzo e-mail valido.
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="profileImage">Immagine profilo</label>
                <input type="file" class="form-control-file" id="profileImage" name="profileImage">
              </div>

            </div>
  
  
            <div class="form-row">
  
              <div class="col-md-5 mb-3">
                <label for="birthdate">Data di nascita</label>
                <input type="date" class="form-control" id="birthdate" name="birthdate" placeholder="Data di nascita"
                       value="<%= moment(session.user.birthdate).format('YYYY-MM-DD') %>" >
                <div class="invalid-feedback">
                  Inserire una data valida.
                </div>
              </div>
              <div class="col-md-5 mb-3">
                <label for="telephone">Telefono</label>
                <input type="tel" class="form-control" id="telephone" name="telephone" placeholder="Telefono"
                       value="<%= session.user.telephone %>" pattern="^[0-9\-\+]{9,15}$">
                <div class="invalid-feedback">
                  Inserire un numero di telefono valido.
                </div>
              </div>
              <div class="col-md-2 mb-3">
                <label for="sex">Sesso</label>
                <select class="form-control" id="sex" name="sex" placeholder="Sesso">
                  <%
                    let options = [ "", "M", "F"];
                    for (let option of options)
                    {
                        let selected = (option == session.user.sex) ? "selected" : "";
                  %>
                  <option value="<%= option %>" <%= selected %>><%= option %></option>
                  <% } %>
                </select>
              </div>
              
            </div>
  
  
          </div>
        </div>
  
        <div class="card mt-5">
  
          <div class="card-header text-white bg-primary">Indirizzo</div>
  
          <div class="card-body">
  
  
            <div class="form-row">
              
              <div class="col-md-9 mb-3">
                <label for="street">Indirizzo</label>
                <input type="text" class="form-control" id="street" name="street" placeholder="Indirizzo e numero civico"
                       value="<%= session.user.address.street %>" >
                <div class="invalid-feedback">
                  Inserire un indirizzo valido
                </div>
              </div>
  
              <div class="col-md-3 mb-3">
                <label for="zipcode">CAP</label>
                <input type="text" class="form-control" id="zipcode" name="zipcode" placeholder="CAP"
                       value="<%= session.user.address.zipcode %>" pattern="[0-9]{5}">
                <div class="invalid-feedback">
                  Inserire un CAP valido.
                </div>
              </div>
  
            </div>
  
  
            <div class="form-row">
  
              <div class="col-md-6 mb-3">
                <label for="city">Città</label>
                <input type="text" class="form-control" id="city" name="city" placeholder="Città"
                       value="<%= session.user.address.city %>">
                <div class="invalid-feedback">
                  Inserire una città valida.
                </div>
              </div>
              <div class="col-md-3 mb-3">
                <label for="state">Comune</label>
                <input type="text" class="form-control" id="state" name="state" placeholder="Comune"
                       value="<%= session.user.address.state %>">
                <div class="invalid-feedback">
                  Inserire un comune valido.
                </div>
              </div>
  
            </div>
  
  
          </div>
        </div>        
  
        <button class="btn btn-primary mt-5" type="submit">Aggiorna dati</button>

        <br /><br />

        <div id="alertSignUpSuccess" style="display: none;" class="alert alert-success" role="alert">
          <strong>Dati aggiornati con successo!</strong>
        </div>

        <div id="alertSignUpError" style="display: none;" class="alert alert-danger" role="alert">
        </div>
  
      </form>
    </div>
  </div>